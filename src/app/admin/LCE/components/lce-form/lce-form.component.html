
<div fxLayout="row" class="row" >

<mat-card fxFlex="60" fxFlex.sm="100" fxFlex.xs="100" fxFlexOffset="20" fxFlexOffset.sm="0" fxFlexOffset.xs="0" >

  <mat-card-header>
    <mat-card-title><h3>{{lceId ? 'Edit life cycle event' : 'Add new life cycle event'}}</h3></mat-card-title>
    <mat-card-subtitle></mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <ii-suggestion [idColumn]="'id'" [name]="'lce_type'"
                   [fieldNameEn]="'name'" [fieldNameFa]="'name_fa'" [placeHolder]="'life cycle event name'"
                   [currentIds]="[]" (add)="lce_type_id = $event.id"></ii-suggestion>

    <ii-suggestion [idColumn]="joinerKey" [name]="joinerType"
                   [fieldNameEn]="'name'" [fieldNameFa]="'name_fa'" [placeHolder]="joinerType"
                   [currentIds]="getCurrentJoinerIds()" (add)=" id1 = $event[joinerKey]"></ii-suggestion>

    <mat-expansion-panel style="margin-bottom: 10px;" (opened)="panelOpenState = true"
                         (closed)="panelOpenState = false">
      <mat-expansion-panel-header>
        <mat-panel-title>
          join with other {{joinerType}}?
        </mat-panel-title>
      </mat-expansion-panel-header>
      <ii-suggestion [idColumn]="joinerKey" [name]="joinerType"
                     [fieldNameEn]="'name'" [fieldNameFa]="'name_fa'" [placeHolder]="joinerType"
                     [currentIds]="getCurrentJoinerIds()" (add)="id2  =$event[joinerKey]"></ii-suggestion>
    </mat-expansion-panel>

    <form (ngSubmit)="modifyLCE()" [formGroup]="lceForm">
      <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column" fxLayoutAlign="start start"
           fxLayoutAlign.sm="center center" fxLayoutAlign.xs="center center">
        <div fxFlex="50" style="width: 100%; margin: 5px">
          <mat-input-container class="field">
            <input matInput type="text" placeholder="Description" formControlName="description" role="description"
                   tabindex="3"/>
          </mat-input-container>
        </div>
        <div fxFlex="50" dir="rtl" style="width: 100%; margin: 5px">
          <mat-input-container class="field farsi">
            <input matInput type="text" placeholder="توضیح" formControlName="description_fa" role="description_fa"
                   tabindex="10"/>
          </mat-input-container>
        </div>
      </div>
      <div fxLayout="row" fxLayout.xs="column" fxLayoutAlign="start start" fxLayoutAlign.xs="center center">
        <div fxFlex="50" style="width: 100%; margin: 5px">
          <mat-form-field class="field">
            <input matInput [matDatepicker]="start_date" placeholder="Start Date" formControlName="start_date"
                   role="start-date" tabindex="6" />
            <mat-datepicker-toggle matSuffix [for]="start_date" tabindex="7"></mat-datepicker-toggle>
            <mat-datepicker #start_date></mat-datepicker>
          </mat-form-field>
        </div>
        <div fxFlex="50" style="width: 100%; margin: 5px">
          <mat-form-field class="field">
            <input matInput [matDatepicker]="end_date" placeholder="End Date" formControlName="end_date"
                   role="end-date" tabindex="8" />
            <mat-datepicker-toggle matSuffix [for]="end_date" tabindex="9"></mat-datepicker-toggle>
            <mat-datepicker #end_date></mat-datepicker>
          </mat-form-field>
        </div>
      </div>
      <div>


        <button mat-raised-button color="primary" type="submit"
                [disabled]="upsertBtnShouldDisabled || !lceForm.valid || (lceId && !anyChanges)" tabindex="20">
          <span>{{lceId ? 'Update' : 'Add'}}</span>
        </button>
        <button mat-raised-button color="warn" type="button" *ngIf="!lceId" (click)="lceForm.reset()"
                tabindex="22">Delete
        </button>

        <button mat-raised-button color="primary" type="button" *ngIf="lceId" (click)="deleteEvent()"
                [disabled]="deleteBtnShouldDisabled" tabindex="21">Delete
        </button>
      </div>
    </form>

  </mat-card-content>
</mat-card>
</div>
